<% if params[:level] == nil || params[:score] == nil%>
    error = '<div class="alert" style="text-align:right; margin:10px;">' +
            '<button type="button" class="close" data-dismiss="alert">&times;</button>' +
            '<strong>تحذير!</strong> حاولت طلب بيانات غير صالحة.' + '</div>';
    $("#zone").append($(error));
<% else %>
  <% won_trophies = Trophy.get_new_trophies_for_gamer(current_gamer.id, params[:level], params[:score]) %>

  <% if won_trophies.length == 0 %>
      success = '<h1 class="award-title">لا يمكنك إنجاز أي انجازات أخرى لهذه المرحلة</h1>';
  <% else %>
      <% won_trophies.map { |nt| current_gamer.trophies << nt } %>
      success = '<h1 class="award-title">لقد انجزت الانجازات التالية!</h1>';
      trophies = [];

      <% won_trophies.each do |t| %>
        trophies.push('<div class="award">' + '<%= t.name %>' + '</div>');
      <% end %>
       
  <% end %>
      $("#zone").append($(success));
      for(var i = 0; i < trophies.length; i++) {
        $("#zone").append($(trophies[i]));
      }
   
<% end %>
